<html>
<head>
<title>rpg</title>
</head>
<body>

<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript" src="js/gamepad.js"></script>
<script type="text/javascript" src="js/Update.js"></script>
<script type="text/javascript" src="js/MapCamera.js"></script>
<script type="text/javascript" src="js/MapView.js"></script>
<script type="text/javascript" src="js/CanvasMapView.js"></script>
<script type="text/javascript" src="js/MapModel.js"></script>
<script type="text/javascript" src="js/KeyWatcher.js"></script>
<script type="text/javascript" src="js/DialogView.js"></script>
<script type="text/javascript" src="js/World.js"></script>
<script type="text/javascript" src="js/game/SimpleInput.js"></script>
<script type="text/javascript">

var input = new SimpleInput();
var world = new World();
var map = new CanvasMapView(10, 10, 0, 640,480, world.getModel());
var dialog = new DialogView(10,10,1,640,480,"res/midJQ.png");

document.body.appendChild(dialog.getDiv());
document.body.appendChild(map.getDiv());

var hero = world.addCharacter(0,0,0);

for (var i=0; i<11; i++)
{
	var hh = world.addCharacter(2,i,5);
}

for (var i=0; i<11; i++)
{
	var hh = world.addCharacter(2,5,i);
}

var someone = world.addCharacter(1,2,2);

world.setOnCollide(function(predator, victim)
{
	
});

var camera = new MapHeroCamera(map, world.getModel(), hero);
map.setCamera(camera);

dialog.hide();

var dialogActions =
{
	zActionOnce: function()
	{
		input.setActions(walkAroundActions);
		dialog.hide();
	}
}

var walkAroundActions =
{
	leftArrowAction: function() { world.moveCharacter(hero, 1) },
	rightArrowAction: function() { world.moveCharacter(hero, 2) },
	upArrowAction: function() { world.moveCharacter(hero, 3) },
	downArrowAction: function() { world.moveCharacter(hero, 0) },
	zActionOnce: function()
	{
		var char = world.getCharacterInFrontOf(hero);
		if (char) {
			input.setActions(dialogActions);
			dialog.show();
			//console.log("meow");
		}
	}
};

input.setActions(walkAroundActions);

BeginUpdating(function()
{
	input.checkInputs();
	dialog.update();
	map.update();
	
}, null)

</script>

</body>
</html>